---
title: 在 Power BI Desktop 中使用自訂格式字串
description: 了解如何在 Power BI Desktop 中自訂格式字串
author: davidiseminger
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 09/11/2019
ms.author: davidi
LocalizationGroup: Create reports
ms.openlocfilehash: 3ec372a51177e5979cdfbca8408e11801aefb414
ms.sourcegitcommit: 8e3d53cf971853c32eff4531d2d3cdb725a199af
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/04/2020
ms.locfileid: "74791590"
---
# <a name="use-custom-format-strings-in-power-bi-desktop"></a>在 Power BI Desktop 中使用自訂格式字串

在 **Power BI Desktop** 中使用自訂格式字串，您可以自訂欄位在視覺效果中的顯示方式，並確保您的報表看起來就像您想要的樣子。

![使用自訂格式字串](media/desktop-custom-format-strings/custom-format-strings-01.png)


## <a name="how-to-use-custom-format-strings"></a>如何使用自訂格式字串

若要建立自訂格式字串，請選取 [模型]  檢視中的欄位，然後從 [屬性]  窗格中選取 [格式]  。

![[格式] 下拉式清單下的 [自訂]](media/desktop-custom-format-strings/custom-format-strings-02.png)

當您從 [格式]  下拉式清單中選取 [自訂]  之後，就可以從常用格式字串清單中選取。 

![使用自訂格式字串](media/desktop-custom-format-strings/custom-format-strings-03.png)


## <a name="supported-custom-format-syntax"></a>支援的自訂格式語法

自訂格式字串遵循 VBA 樣式語法 (VBA 在 Excel 和其他 Microsoft 產品中很常見)，但不支援其他產品中使用的所有語法。 

下表定義 Power BI 中支援的語法。


下表顯示支援的**日期符號**：

| **符號** | **範圍** |
| --- | --- |
| _d_ | 1-31 (月中的日，沒有前置零) |
| _dd_ | 01-31 (月中的日，包含前置零) |
| _m_ | 1-12 (年中的月份，沒有前置零，從 1 月 = 1 開始) |
| _mm_ | 01-12 (年中的月份，包含前置零，從 1 月 = 01 開始) |
| _mmm_ | 顯示縮寫月份名稱 (回曆月份名稱沒有縮寫) |
| _mmmm_ | 顯示完整月份名稱 |
| _yy_ | 00-99 (年份的最後兩位數) |
| _yyyy_ | 100-9999 (三或四位數的年份) |

下表顯示支援的**時間符號**：

| **符號** | **範圍** |
| --- | --- |
| _h_ | 0-23 (1-12，附加 &quot;AM&quot; 或 &quot;PM&quot;) (一天的小時，沒有前置零) |
| _hh_ | 00-23 (01-12，附加 &quot;AM&quot; 或 &quot;PM&quot;) (一天的小時，包含前置零) |
| _n_ | 0-59 (小時的分鐘，沒有前置零) |
| _nn_ | 00-59 (小時的分鐘，包含前置零) |
| _m_ | 0-59 (小時的分鐘，沒有前置零)。 只有在前面加上 _h_ 或 _hh_ 時 |
| _mm_ | 00-59 (小時的分鐘，包含前置零)。 只有在前面加上 _h_ 或 _hh_ 時 |
| _s_ | 0-59 (分鐘的秒，沒有前置零) |
| _ss_ | 00-59 (分鐘的秒，包含前置零) |


您可以查看有關如何設定自訂值字串格式的[範例](https://docs.microsoft.com/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications#example)。

數字的使用者定義格式運算式可以有一到三個區段 (以分號分隔)。 如果您在兩者之間包含分號，則不會顯示遺失的區段 (它會是 &quot;&quot;)。 如果未指定分號，則會使用正值格式。

以下是不同值字串的不同格式範例：

|   | **格式字串** |   |   |   |
| --- | --- | --- | --- | --- |
| **值** | **0.00;-0.0;&quot;零&quot;** | **0.00;;** | **0.00;-0.0;** | **0.00;** |
| **-1.234** | -1.2 | &quot;&quot; | -1.2 | &quot;&quot; |
| **0** | &quot;零&quot; | &quot;&quot; | &quot;&quot; | 0.00 |
| **1.234** | 1.23 | 1.23 | 1.23 | 1.23 |

下表會識別預先定義的**具名日期和時間格式**：

| **格式名稱** | **描述** |
| --- | --- |
| **一般日期** | 顯示日期和/或時間，例如 4/3/93 05:34 PM。 如果沒有小數部分，則只顯示日期，例如 4/3/93。 如果沒有整數部分，則只顯示時間，例如 05:34 PM。 日期顯示取決於您的系統設定。 |
| **完整日期** | 根據系統的完整日期格式來顯示日期。 |
| **簡短日期** | 使用系統的簡短日期格式來顯示日期。 |
| **完整時間** | 使用系統的完整時間格式顯示時間；包含小時、分鐘、秒。 |
| **簡短時間** | 顯示使用 24 小時格式的時間，例如 17:45。 |

具名數值格式

下表會識別預先定義的**具名數值格式**：

| **格式名稱** | **描述** |
| --- | --- |
| **一般數字** | 不使用千位分隔符顯示數字。 |
| **貨幣** | 使用千位分隔符顯示數字 (如果有的話)；在小數分隔符號的右邊顯示兩位數。 輸出是以系統地區設定為基礎。 |
| **固定** | 在小數分隔符號的左邊顯示至少一個數字，右邊顯示至少兩位數。 |
| **標準** | 使用千位分隔符顯示數字，在小數分隔符號的左邊顯示至少一個數字，右邊顯示至少兩位數。 |
| **百分比** | 顯示乘以 100 的數字，並在右邊附加百分比符號 ( **%** )；一律會在小數分隔符號的右邊顯示兩位數。 |
| **科學記號** | 使用標準科學記號標記法。 |



下表列出您可以用來建立**使用者定義日期/時間格式**的字元。

| **字元** | **描述** |
| --- | --- |
| ( **:** ) | 時間分隔符號。 在某些地區設定中，可能會使用其他字元來代表時間分隔符號。 時間分隔符號會在設定時間值格式時，分隔小時、分鐘和秒。 在格式化輸出中作為時間分隔符號使用的實際字元是由您的系統設定所決定。 |
| ( **/** ) | 日期分隔符號。 在某些地區設定中，可能會使用其他字元來代表日期分隔符號。 日期分隔符號會在設定日期值格式時，分隔日、月和年。 在格式化輸出中用來作為日期分隔符號的實際字元，是由您的系統設定所決定。 |
| d | 以無前置零的數字顯示月份日期 (1–31)。 |
| dd | 以包含前置零的數字顯示月份日期 (01–31)。 |
| ddd | 顯示星期幾縮寫 (Sun–Sat)。 當地語系化。 |
| dddd | 顯示星期幾全名 (星期日–星期六)。 當地語系化。 |
| 男性 | 以無前置零的數字顯示月份 (1–12)。 如果 m 緊接在 h 或 hh 之後，則會顯示分鐘而非月份。 |
| mm | 以包含前置零的數字顯示月份 (01–12)。 如果 m 緊接在 h 或 hh 之後，則會顯示分鐘而非月份。 |
| mmm | 顯示月份縮寫 (Jan–Dec)。 當地語系化。 |
| mmmm | 顯示完整月份名稱 (一月–十二月)。 當地語系化。 |
| yy | 以 2 位數數字顯示年份的數位 (00–99)。 |
| yyyy | 以 4 位數數字顯示年份 (100–9999)。 |
| h | 以無前置零的數字顯示小時 (0–23)。 |
| hh | 以包含前置零的數字顯示小時 (00–23)。 |
| n | 以無前置零的數字顯示分鐘 (0–59)。 |
| nn | 以包含前置零的數字顯示分鐘 (00–59)。 |
| s | 以無前置零的數字顯示秒 (0–59)。 |
| ss | 以包含前置零的數字顯示秒 (00–59)。 |
| AM/PM | 使用 12 小時制，並在中午之前的任何小時顯示大寫 AM；介於中午和下午 11:59 之間的任何小時顯示大寫 PM。 |

下表列出您可以用來建立**使用者定義數字格式**的字元。

| **字元** | **描述** |
| --- | --- |
| 無 | 不使用格式顯示數字。 |
| ( **0** ) | 數字預留位置。 顯示數字或零。 如果運算式在格式字串中出現 0 的位置有一個數字，則會顯示它；否則，在該位置顯示零。 如果數字的位數少於格式運算式中的零 (小數的兩邊)，則顯示前置零或後置零。 如果數字在小數分隔符號右側的位數，多於格式運算式中小數分隔符號右側的零，則將數字四捨五入為等同於零位數的小數位數。 如果數字在小數分隔符號左側的位數，多於格式運算式中小數分隔符號左側的零，則顯示額外的數字而不進行修改。 |
| ( **#** ) | 數字預留位置。 顯示數字或不顯示。 如果運算式在格式字串中出現 # 的位置有一個數字，則顯示它；否則，在該位置不顯示任何內容。 此符號的作用類似 0 數字預留位置，但如果數字的位數與格式運算式中運算式兩側的 # 字元相同或更少，則不顯示前置零和後置零。 |
| ( **.** ) | 小數預留位置。 在某些地區設定中，會使用逗號做為小數分隔符號。 小數預留位置會決定小數分隔符號左邊和右邊顯示多少位數。 如果格式運算式只包含此符號左邊的數字記號，小於 1 的數字就會以小數分隔符號開頭。 若要顯示含有小數位數的前置零，請使用 0 作為小數分隔符號左邊的第一個數字預留位置。 在格式化輸出中用來作為小數預留位置的實際字元，取決於您的系統所辨識的數字格式。 |
| ( **%)** | 百分比預留位置。 運算式乘以 100。 百分比字元 ( **%** ) 會插入在格式字串中出現的位置。 |
| ( **,** ) | 千位分隔符號。 在某些地區設定中，會使用句點做為千位分隔符。 千位分隔符會在小數分隔符號左邊有四個以上位置的數字中，分隔百位數與千位數。 如果格式包含以數字預留位置 ( **0**  或 **#** ) 括住的千位分隔符，則會指定千位分隔符的標準用法。 兩個相鄰的千位分隔符或小數分隔符號左側的千位分隔符 (無論是否指定小數) 表示&quot;將數字除以 1000 來調整數值，並視需要進行捨入。&quot;例如，您可以使用格式字串 &quot;##0,,&quot;，將 1000000000 表示為 100。 小於 1 百萬的數字顯示為 0。 在小數分隔符號左側以外的任何位置中，兩個相鄰的千位分隔符會被視為指定使用千位分隔符。 在格式化輸出中做為千位分隔符的實際字元，取決於您的系統所能辨識的數字格式。 |
| ( **:** ) | 時間分隔符號。 在某些地區設定中，可能會使用其他字元來代表時間分隔符號。 時間分隔符號會在設定時間值格式時，分隔小時、分鐘和秒。 在格式化輸出中作為時間分隔符號使用的實際字元是由您的系統設定所決定。 |
| ( **/** ) | 日期分隔符號。 在某些地區設定中，可能會使用其他字元來代表日期分隔符號。 日期分隔符號會在設定日期值格式時，分隔日、月和年。 在格式化輸出中用來作為日期分隔符號的實際字元，是由您的系統設定所決定。 |
| ( **E- E+ e- e+** ) | 科學格式。 如果格式運算式在 E-、E+、e 或 e+ 的右邊至少包含一個數字預留位置 ( **0**  或 **#** )，則該數字會以科學格式顯示，而 E 或 e 會插入到該數字和其指數之間。 右邊數字預留位置的數目，會決定指數中數字的數目。 使用 E- 或 e- 在負指數旁邊加上負號。 使用 E+ 或 e+ 在正指數旁邊加上加號。 |
| **- + $**  ( ) | 顯示常值字元。 若要顯示非列出的字元，請在其前面加上反斜線 (\) 或以雙引號 (&quot; &quot;) 括住。 |
| ( * *\** ) | 顯示格式字串中的下一個字元。 若要將有特殊意義的字元作為常值字元顯示，請在其前面加上反斜線 (\)。 反斜線本身不會顯示。 使用反斜線與以雙引號括住下一個字元的方式相同。 若要顯示反斜線，請使用兩個反斜線 (\\)。 不能顯示為常值字元的字元範例，包括日期格式和時間格式字元 (a、c、d、h、m、n、p、q、s、t、w、/ 和 :)、數值格式字元 (#、0、%、E、e、逗號和句號)，以及字串格式字元 (@、&amp;、\&lt;、\&gt; 和 !)。 |
| (&quot;ABC&quot;) | 將字串顯示在雙引號 (&quot; &quot;) 內。 |


## <a name="next-steps"></a>後續步驟
您可能也會對下列文章感興趣：

* [VBA 格式字串](https://docs.microsoft.com/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications#example)
* [Power BI Desktop 中的量值](desktop-measures.md)
* [Power BI Desktop 中的資料類型](desktop-data-types.md)
* [設定資料表格式化的條件](desktop-conditional-table-formatting.md)

